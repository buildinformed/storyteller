name = "storyteller-orchestrator"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

[[migrations]]
tag = "v1"
new_classes = ["JobStateMachine"]

# Durable Object binding
[[durable_objects.bindings]]
name = "jobStateMachine"
class_name = "JobStateMachine"

# Queue binding - producer
[[queues.producers]]
binding = "media_steps"
queue = "media-steps"

# Queue binding - consumer
[[queues.consumers]]
queue = "media-steps"
max_batch_size = 1
max_batch_timeout = 60
max_concurrency = 250

# R2 binding
[[r2_buckets]]
binding = "bucket"
bucket_name = "storyteller-artifacts"
