name = "storyteller"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

[[migrations]]
tag = "v2"
new_classes = ["JobController"]

# Durable Object binding
[[durable_objects.bindings]]
name = "JOBS"
class_name = "JobController"

# Queue binding - producer
[[queues.producers]]
binding = "STEP_QUEUE"
queue = "media-steps"

# Queue binding - consumer
[[queues.consumers]]
queue = "media-steps"
max_batch_size = 1
max_batch_timeout = 60
max_concurrency = 250

# R2 binding
[[r2_buckets]]
binding = "ARTIFACTS"
bucket_name = "storyteller-artifacts"
